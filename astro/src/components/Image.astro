---
import { getImageProps } from "@utils/sanity";
import type { RawImage, Image } from "../types";

interface Props {
  class?: string;
  image: RawImage;
  width?: number;
}

const { class: className, image: node, width } = Astro.props;
let image: Image | undefined;

try {
  image = node && node.asset && getImageProps({ image: node, maxWidth: width });
} catch (error) {
  console.error(error);
}
---

{
  image && (
    <figure class="relative">
      <img
        class="block h-full w-full object-cover"
        class:list={className}
        loading="lazy"
        src={image.src}
        srcset={image.srcset}
        sizes={image.sizes}
        width={image.width}
        height={image.height}
        alt={node.alt || ""}
        title={node.alt}
      />
      <img
        class="absolute inset-0 left-0 top-0 h-full w-full object-cover"
        src={image.placeholder}
        alt=""
        aria-hidden="true"
        role="presentation"
      />
    </figure>
  )
}
